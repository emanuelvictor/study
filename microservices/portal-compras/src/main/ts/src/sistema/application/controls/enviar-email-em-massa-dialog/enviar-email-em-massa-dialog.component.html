<h1 mat-dialog-title>Enviar email para fornecedores cadastrados</h1>
<div style='font-size: 13px;margin-top: -19px;color: #4C4C4C'>
  Atenção, este e-mail será enviado para todos os fornecedores cadastrados no portal.
</div>

<form novalidate [formGroup]='form' (ngSubmit)='saveEntity(form)'>

  <div mat-dialog-content style='margin-top: 30px; max-height: 100%'>
    <div layout='column'>
      <div layout='row'>
        <mat-form-field flex>
          <input placeholder='Assunto do email'
                 [(ngModel)]='email.assunto' flex
                 formControlName='assunto' required
                 matInput id='assunto' name='assunto'/>
          <mat-error>
            Campo obrigatório
          </mat-error>
        </mat-form-field>
      </div>

      <div layout='row'>
        <mat-form-field>
          <mat-select placeholder='Status' [(value)]='email.status'>
            <mat-option [value]="null"></mat-option>

            <mat-option [value]="'EM_CRIACAO'">EM CRIAÇÃO</mat-option>
            <mat-option [value]="'EM_ANALISE'">EM ANÁLISE</mat-option>
            <mat-option [value]="'APROVADO'">APROVADO</mat-option>
            <mat-option [value]="'RECUSADO'">RECUSADO</mat-option>
          </mat-select>
        </mat-form-field>

        <horizontal-space></horizontal-space>

        <mat-form-field flex flex-md='20'>
          <mat-select [compareWith]='compareCategorias'
                      [(ngModel)]='email.categorias' multiple
                      formControlName='categorias' placeholder='Categorias'>
            <mat-select-trigger>

              {{email?.categorias?.length === 1 ? email?.categorias[0]?.nome : (email?.categorias?.length > 1 ? (email?.categorias[0]?.nome + ',' + email?.categorias[1]?.nome) : '')}}
              <span *ngIf='email?.categorias?.length > 2'>
                (+{{email?.categorias?.length - 2}} {{email?.categorias?.length === 3 ? 'outro' : 'outros'}})
              </span>

            </mat-select-trigger>
            <mat-option [value]='categoria' *ngFor='let categoria of categorias'>
              {{categoria?.nome}}
            </mat-option>
          </mat-select>
          <mat-error>
            Campo obrigatório
          </mat-error>
        </mat-form-field>
      </div>

      <div layout='row'>
        <mat-form-field flex>
            <textarea [(ngModel)]='email.conteudo' maxlength='250' matInput
                      placeholder='Conteúdo do e-mail' style='height: 200px'
                      id='conteudo' name='conteudo' formControlName='conteudo'>
            </textarea>
        </mat-form-field>
      </div>

      <vincular-anexos-email [(anexosEmail)]='email.anexosEmail'
                             [form]='form' (remove)='removeAnexo($event)'>
      </vincular-anexos-email>
    </div>
  </div>

  <mat-divider></mat-divider>

  <div mat-dialog-actions>
    <button mat-button color='accent' type='button' [mat-dialog-close]='false'>
      Cancelar
    </button>
    <button color='primary' mat-raised-button>
      <mat-icon>send</mat-icon>
      <span>Enviar</span>
    </button>
  </div>
</form>
